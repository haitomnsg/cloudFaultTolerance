events {}

http {
    upstream backend {
        server web1:5000;
        server web2:5000;
        server web3:5000;
        server web4:5000;
    }

    server {
        listen 80;

        # Serve the UI from the default nginx html root
        location / {
            root /usr/share/nginx/html;
            index index.html;
        }

        # Backend API that is load-balanced across the 4 web servers
        location /api {
            proxy_pass http://backend;
        }

        # Control endpoint used by the UI to toggle servers on/off
        location /control {
            proxy_pass http://backend;
        }
    }
}
